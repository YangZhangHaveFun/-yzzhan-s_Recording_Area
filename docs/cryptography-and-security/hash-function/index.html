<!DOCTYPE html>
<html lang="en">

<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<meta http-equiv="X-UA-Compatible" content="ie=edge">
	<link rel="apple-touch-icon" sizes="180x180" href="/yzzhan/apple-touch-icon.png">
	<link rel="icon" type="image/png" sizes="32x32" href="/yzzhan/favicon-32x32.png">
	<link rel="icon" type="image/png" sizes="16x16" href="/yzzhan/favicon-16x16.png">
	<link rel="manifest" href="/yzzhan/site.webmanifest">
	<link rel="mask-icon" href="/yzzhan/safari-pinned-tab.svg" color="">
	<link rel="shortcut icon" href="/yzzhan/favicon.ico">
	<title>Detailed Hash Function</title>
	<link rel="stylesheet" href="/yzzhan/css/style.min.bde2f5cd3b77a52d8db26f638dfed4b52085d3ea252fdf5746658b9883382220.css" integrity="sha256-veL1zTt3pS2Nsm9jjf7UtSCF0+olL99XRmWLmIM4IiA=">
	
</head>

<body id="page">
	
	<header id="site-header" class="animated slideInUp faster">
		<div class="hdr-wrapper section-inner">
			<div class="hdr-left">
				<div class="site-branding">
					<a href="https://yangzhanghavefun.github.io/yzzhan/">Yzzhan Tech Repo</a>
				</div>
				<nav class="site-nav hide-in-mobile">
					<a href="/yzzhan/amazon/">Amazon</a>
					<a href="/yzzhan/cryptography-and-security/">Cryptography and Security</a>
					<a href="/yzzhan/posts/">Posts</a>
					<a href="/yzzhan/about-hugo/">About</a>
					<a href="/yzzhan/tutorial/">tutorials</a>
				</nav>
			</div>
			<div class="hdr-right">
				<div class="hdr-icons">
					<span class="hide-in-mobile"><a href="https://twitter.com/" target="_blank" rel="noopener"><span class="screen-reader-text">twitter</span><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-twitter"><path d="M23 3a10.9 10.9 0 0 1-3.14 1.53 4.48 4.48 0 0 0-7.86 3v1A10.66 10.66 0 0 1 3 4s-4 9 5 13a11.64 11.64 0 0 1-7 2c9 5 20 0 20-11.5a4.5 4.5 0 0 0-.08-.83A7.72 7.72 0 0 0 23 3z"></path></svg></a><a href="https://instagram.com/" target="_blank" rel="noopener"><span class="screen-reader-text">instagram</span><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-instagram"><rect x="2" y="2" width="20" height="20" rx="5" ry="5"></rect><path d="M16 11.37A4 4 0 1 1 12.63 8 4 4 0 0 1 16 11.37z"></path><line x1="17.5" y1="6.5" x2="17.5" y2="6.5"></line></svg></a><a href="https://github.com/" target="_blank" rel="noopener"><span class="screen-reader-text">github</span><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-github"><path d="M9 19c-5 1.5-5-2.5-7-3m14 6v-3.87a3.37 3.37 0 0 0-.94-2.61c3.14-.35 6.44-1.54 6.44-7A5.44 5.44 0 0 0 20 4.77 5.07 5.07 0 0 0 19.91 1S18.73.65 16 2.48a13.38 13.38 0 0 0-7 0C6.27.65 5.09 1 5.09 1A5.07 5.07 0 0 0 5 4.77a5.44 5.44 0 0 0-1.5 3.78c0 5.42 3.3 6.61 6.44 7A3.37 3.37 0 0 0 9 18.13V22"></path></svg></a></span>
					<button id="menu-btn" class="hdr-btn"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-menu"><line x1="3" y1="12" x2="21" y2="12"></line><line x1="3" y1="6" x2="21" y2="6"></line><line x1="3" y1="18" x2="21" y2="18"></line></svg></button>
				</div>
			</div>
		</div>
	</header>
	<div id="mobile-menu" class="animated fast" style="display: none;">
		<ul>
			<li><a href="/yzzhan/amazon/">Amazon</a></li>
			<li><a href="/yzzhan/cryptography-and-security/">Cryptography and Security</a></li>
			<li><a href="/yzzhan/posts/">Posts</a></li>
			<li><a href="/yzzhan/about-hugo/">About</a></li>
			<li><a href="/yzzhan/tutorial/">tutorials</a></li>
		</ul>
	</div>

	<main class="site-main section-inner thin animated fadeIn faster">
		<h1>Detailed Hash Function</h1>
		<div class="content">
			

<h1 id="hash-function">Hash Function</h1>

<p>There will be three topics related to <strong>HASH FUNCTION</strong> in this article. Generally, <strong>Hash Function</strong> could be divided into two part, <em>Block cipher construct</em> and <em>dedicated hash function</em>. Our focus is on dedicated function, which contains three aspects.</p>

<ol>
<li>MD4 Family

<ol>
<li>MD5</li>
<li>SHA-1</li>
<li>SHA-3</li>
</ol></li>
<li>SHA-3</li>
<li>Others</li>
</ol>

<h2 id="properties-of-hash-function">Properties of Hash Function</h2>

<h2 id="sha-1">SHA-1</h2>

<h3 id="overview">Overview</h3>

<p>The general idea for SHA-1 is to transfer the message with any length into 160 bits.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></pre></td>
<td class="lntd">
<pre class="chroma">                            __________
                            |        |   (160 bits)
    x(input)  ------------&gt; | SHA-1  |--------------&gt; H(x)
                            |________|</pre></td></tr></table>
</div>
</div>
<h3 id="internal-construction">Internal Construction</h3>

<p>SHA-1 uses the Merkle-Damard construction to implement HASH function(already broken).</p>

<p>Here we shows a more specific SHA-1 function diagram.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span></pre></td>
<td class="lntd">
<pre class="chroma">        x = (x_1,x_2,.....,x_n)
                |
                |
            ____|____
            |Padding|
            |_______|
                |                      ______________________
                | X_A(512 bits)        |                    |
                |                      | H_A-1(160bits)     |
            ____|______________________|________            |
            \       Compression function      /             |
             \_______________________________/              |
                       |    ^                               |
                       |    |_______________________________|
                       |
                    H(x) (160bits)</pre></td></tr></table>
</div>
</div>
<p>Further more, the technical detailed construction of compression function is :</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span></pre></td>
<td class="lntd">
<pre class="chroma">         __________________
        | Message schedule |
        |__________________|                __________________
                |                           | H_i-1(160 bits) |
                |     W_0(32 bits)      ____|____             |
                |---------------------&gt;| Round 0 |            |
                |                      |_________|            |
                |                           |                 |
                |                           |                 |
                |     W_1(32 bits)      ____|____             |
                |---------------------&gt;| Round 1 |            |
                |          .           |_________|            |
                |          .                |                 |
                |          .                |                 |
                |                           |                 |
                |     W_79(32 bits)     ____|_____            |
                |---------------------&gt;| Round 79|            |
                                       |_________|            |
                                            |                 |
                                            |                 |
                                        ____|_____            |
                                       |   EOR   |&lt;-----------|
                                       |_________|</pre></td></tr></table>
</div>
</div>
<h3 id="sha-1-properties">SHA-1 Properties</h3>

<ol>
<li>Num of Rounds : 20*4 = 80 rounds</li>
<li>Num of Stages : 4
Stage 1&mdash;&mdash;&gt; Round j = 0-19
Stage 2&mdash;&mdash;&gt; Round j = 20-39
Stage 3&mdash;&mdash;&gt; Round j = 40-59
Stage 4&mdash;&mdash;&gt; Round j = 60-79</li>

<li><p>Input of each Round:</p>

<ol>
<li>5*32 bits input(A,B,C,D,E)</li>

<li><p>Message input W_j (32 bits)</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></pre></td>
<td class="lntd">
<pre class="chroma">        A      B      C       D       E
       _|______|______|_______|_______|_
W_j--&gt;|             Round j             |
      |_________________________________|</pre></td></tr></table>
</div>
</div></li>
</ol></li>
</ol>

<h3 id="remaining-problem-when-implementing">Remaining Problem when implementing</h3>

<ol>
<li>Internal algorithm of rounds</li>
<li>Construction of Message Schedule</li>
</ol>

<p><1> Round Function</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span></pre></td>
<td class="lntd">
<pre class="chroma">         _________________________________________________
        |    A    |    B    |    C    |    D    |    E    |
        |_________|_________|_________|_________|_________|
         |   |       | |        |         | |       |
         |   |       | |        |         | |       |
         |   |       | _\_______|        /  |       |
         |   |       | | \ _____|______ /   |       |
         |   |       | |  |     f_t    |----|-----&gt;EOR
         |   |       | |  |____________|    |       |
         |   |       | |                    |       |
         |   |       | \                    |       |
         |  _|___    |  \                   |       |
         | |&lt;&lt;&lt;5 |---|---\------------------|-----&gt;EOR
         | |_____|   |    \                 |       |
         |           |     \                |       |
         |         __|__    \               |       |
         |        |&lt;&lt;&lt;30|    \              |      EOR&lt;-------W_j
         |        |_____|     \             |       |
          \          |         \_________   |       |
           \         |                   |  |       |
            \        |                   |  |      EOR&lt;-------k_t
             \        \                  |  |       |
              \        \                 |  |      /
            ___\________\________________|__|_____/
           |    \        \_______        |  |
           |     \               |       |  |_________
           |      \              |       |            |
         __|_______\_____________|_______|____________|___
        |    A    |    B    |    C    |    D    |    E    |
        |_________|_________|_________|_________|_________|</pre></td></tr></table>
</div>
</div>
<p>f_t(function) and k_t(constant) are constant given input according to the number of stage t.</p>

<p><2>Message Schedule
As we mentioned round function before, there is a kind of input named w_j, which is constant number. Here we show the calculation process for each round(there will be 80 different values of w as there are 80 rounds in SHA-1).</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span></pre></td>
<td class="lntd">
<pre class="chroma">         X_A
          |
          |--------512 bits
          |
          |---w_0
          |
          |---w_1
          |
          |    .
          .    .
          .    .
          .    .
          |____w_79

                |&lt;-       512 = 32*16        -&gt;|
          x_i = x_i^0, x_i^1, x_i^2,.....,x_i^15
                  |      |      |           |
                  |      |      |           |
                 w_0    w_1    w_2   ...   w_15 .............w_79

        w_j = w_j-16 XOR x_j-14 XOR x_j-8 XOR x_j-3  (16 &lt;= j &lt;= 79)</pre></td></tr></table>
</div>
</div>
<h2 id="sha-3">SHA-3</h2>

<p>The algorithm of SHA-3 is much more complex than  SHA-1. Here we only record the high level of it and it&rsquo;s totally different from the algorithm of SHA-1. The core algorithm is Keccark.</p>

<p>The main thought of construction is kind of sponge construction.
    -absorbing phase: input x_i is read-in and processed.
    -squeezing phase: output is produced.</p>

<p>The parameter of sponge construction:
    -state:   b = 25*2^e,  e = 0, 1, 2, 3, 4, 5, 6(SHA-3).
    -number of round:    n_r = 12 +2l &mdash;&mdash;&gt; 12 + 2*6 = 24</p>

<p>Here we show the table of sponge construction.
        ouput   |   b   |   r   |   c   |
        &mdash;&mdash;&ndash;|&mdash;&mdash;-|&mdash;&mdash;-|&mdash;&mdash;-|&ndash;
        224     | 1600  |  1152 |  448  |
        &mdash;&mdash;&ndash;|&mdash;&mdash;-|&mdash;&mdash;-|&mdash;&mdash;-|&ndash;
        256     | 1600  |  1088 |  512  |
        &mdash;&mdash;&ndash;|&mdash;&mdash;-|&mdash;&mdash;-|&mdash;&mdash;-|&ndash;
        384     | 1600  |  832  |  768  |
        &mdash;&mdash;&ndash;|&mdash;&mdash;-|&mdash;&mdash;-|&mdash;&mdash;-|&ndash;
        512     | 1600  |  576  |  1024 |
        &mdash;&mdash;&ndash;|&mdash;&mdash;-|&mdash;&mdash;-|&mdash;&mdash;-|&ndash;</p>

<p>The general idea of Kaccak algorithm is :</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><span class="lnt">1
</span><span class="lnt">2
</span></pre></td>
<td class="lntd">
<pre class="chroma">    m ---------&gt; preprocessing --------&gt; Inner keccak --------&gt; y_2,y_1,y_0 = h(m)
    padding ---&gt;</pre></td></tr></table>
</div>
</div>
<h1 id="reference">Reference</h1>

<p>Finally, there are two ref videos introducing the algorithms of Hash Function perfectly. The firstly video introduced the SHA-1 while the second focused on SHA-3.</p>

<p><a href="http://www.youtube.com/watch?v=JIhZWgJA-9o" target="_blank"><img src="http://img.youtube.com/vi/JIhZWgJA-9o/0.jpg" alt="IMAGE ALT TEXT HERE" /></a></p>

		</div>
	</main>

	<footer id="site-footer" class="section-inner thin animated fadeIn faster">
		<p>&copy; 2018 <a href="https://yangzhanghavefun.github.io/yzzhan/">Yang Zhang</a> &#183; <a href="https://creativecommons.org/licenses/by-nc/4.0/" target="_blank" rel="noopener">CC BY-NC 4.0</a></p>
		<p>Made with <a href="https://gohugo.io/" target="_blank" rel="noopener">Hugo</a> &#183; Theme <a href="https://github.com/Track3/hermit" target="_blank" rel="noopener">Hermit</a> &#183; <a href="https://yangzhanghavefun.github.io/yzzhan/posts/index.xml" target="_blank" title="rss"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-rss"><path d="M4 11a9 9 0 0 1 9 9"></path><path d="M4 4a16 16 0 0 1 16 16"></path><circle cx="5" cy="19" r="1"></circle></svg></a></p>
	</footer>
	<script>let haveHeader = true;</script>

	<script src="/yzzhan/js/main.min.00689ba18bbf9422fda222b02b555f01d54bfbb9b6d02f9bcffad67bdb2ff2cd.js" integrity="sha256-AGiboYu/lCL9oiKwK1VfAdVL+7m20C+bz/rWe9sv8s0="></script>
	
</body>

</html>